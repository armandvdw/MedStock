<!DOCTYPE html>
<html>
<head>
    <title>Bootstrap Case</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/leaflet.css" type="text/css"/>
    <link rel="stylesheet" href="../css/bootstrap-table.css"/>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script src="../js/bootstrap-table.js"></script>
    <script src="../js/jquery.event.drag-2.2.js"></script>
    <script src="../js/leaflet.js"></script>
    <script src="../js/main.js"></script>
</head>

<body style="height: 100%">
<nav class="navbar navbar-default">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href="/home">Med-Stock Management</a>
        </div>
        <div>
            <ul class="nav navbar-nav">
                <li><a href="/home">Home</a></li>
                <li><a href="/reports">Reports</a></li>
                <li><a href="/map">Map</a></li>
                <li class="active"><a href="/management">Management</a></li>
            </ul>
        </div>
    </div>
</nav>

<div class="container">
    <div class="jumbotron">
        <h1>Med-Stock Data Management</h1>

        <p>To Add, Delete, Update and view data. . . </p>
    </div>
</div>

<!--This is the forms needed for the crud operations-->
<div class="container" style="background-color: floralwhite">

    <div class="container">
        <table id="table-data"></table>
    </div>

    <div id="table-toolbar">
        <button type="button" class="btn btn-default" data-toggle="modal" data-target="#create-modal">Create</button>
        <button type="button" class="btn btn-default" id="btn-update-clinic">Update</button>
        <button type="button" class="btn btn-danger" id="btn-delete-clinic">Delete</button>
        <button type="button" class="btn btn-default" id="btn-low-stock">Low Stock</button>
        <button type="button" class="btn btn-default" id="btn-all-clinics">All Clinics</button>
    </div>


    <!-- Modal -->
    <div class="modal fade" id="create-modal" tabindex="-1" role="dialog" aria-labelledby="createFormModal"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span
                            aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title" id="myModalLabel">Create New Clinic</h4>
                </div>
                <div class="modal-body">

                    <!-- The form is placed inside the body of modal -->
                    <form id="create-form" class="form-horizontal">

                        <div class="form-group">
                            <label class="col-sm-3 control-label">Clinic Name</label>

                            <div class="col-sm-5">
                                <input type="text" class="form-control" name="clinicName"/>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-3 control-label">Country Name</label>

                            <div class="col-sm-5">
                                <input type="text" class="form-control" name="countryName"/>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-3 control-label">Nevirapine</label>

                            <div class="col-sm-5">
                                <input type="text" class="form-control" name="nevirapineStock"/>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-3 control-label">Stavudine</label>

                            <div class="col-sm-5">
                                <input type="text" class="form-control" name="stavudineStock"/>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-3 control-label">Zidotabine</label>

                            <div class="col-sm-5">
                                <input type="text" class="form-control" name="zidotabineStock"/>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-3 control-label">Latitude</label>

                            <div class="col-sm-5">
                                <input type="text" class="form-control" name="latitude" id="lat"/>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-3 control-label">Longitude</label>
                            <div class="col-sm-5">
                                <input type="text" class="form-control" name="longitude" id="lon"/>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-5 col-sm-offset-3">
                                <button type="submit" id="button-create">Create</button>
                            </div>
                        </div>
                    </form>
                    <button class="btn btn-primary btn-lg" data-toggle="modal" href="#mapModal">Select On Map</button>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary" id="button-update">Save changes</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="mapModal" tabindex="-1" role="dialog" aria-labelledby="mapModal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title" id="myMapModal">Create New Clinic</h4>
                </div>
                <div class="modal-body">
                    <div id="map" style="height: 600px"></div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary" data-toggle="modal" data-target="#mapModal">Save</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>

    $(function() {
        $("#button-create").click(function(){
            var clinic = $("#create-form").serialize();
            createClinic(clinic);
        });


        $("#button-update").click(function(){
            alert("updated");
            alert($("#loginForm").serialize())
        });

        var lat = $("#lat");
        var lon = $("#lon");


        var map = L.map('map').setView([51.505, -0.09], 13);

        L.tileLayer('https://{s}.tiles.mapbox.com/v3/{id}/{z}/{x}/{y}.png', {
            maxZoom: 18,
            attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
                    '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
                    'Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
            id: 'examples.map-i875mjb7'
        }).addTo(map);

        var popup = L.popup();


        function onMapClick(e) {
            popup
                    .setLatLng(e.latlng)
                    .setContent(e.latlng.lat +" , " + e.latlng.lng)
                    .openOn(map);

            lat.val(e.latlng.lat);
            lon.val(e.latlng.lng);
        }

        map.on('click', onMapClick);

        $('#mapModal').on('show.bs.modal', function(){
            setTimeout(function() {
                map.invalidateSize();
            }, 500);
        });
        loadGrid();
    });

</script>


<script src="../js/main.js"></script>
<script> //$(document).onLoad(loadGrid());</script>
</body>
</html>
